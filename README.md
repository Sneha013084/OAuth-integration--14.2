# OAuth-integration--14.2

## How an attacker can do CSRF in OAuth:

CSRF (Cross-Site Request Forgery) occurs when an attacker tricks a user into executing an OAuth request they didn’t intend.In an OAuth flow, this could make the app link the user’s session to the attacker’s 

account.The state parameter is a random, unique value generated by the client before redirecting to the authorization server.The server includes this state in the redirect response along with the authorization 

code.The client verifies that the returned state matches the one it originally sent.If the state matches request is valid; if not  the response is rejected.It prevents attackers from injecting their own 

authorization codes and protects the user’s session.


## Redirect URI attack/Leaky redirect_uri:

OAuth servers must validate the full redirect_uri (scheme, domain, port, and path) before redirecting the user. If validation is missing or weak, attackers can trick users into completing the OAuth flow, sending 

the authorization code to a malicious site. Common mistakes includes validating only the domain/allowing subdomains/using wildcards etc.

hypothetical scenario : Like a valid redirect URI for a client app is https://product.com/online, the server only checks for the domain is product.com ignoring the path. An attacker sets up a URL like 

https://product.com/malicious  and tricks a user into starting the OAuth flow. The authorization server redirects the user to https://product.com/malicious with the authorization code in the URL.The attacker 

controls this /malicious page and can read the code from the URL and exchange it for an access token.Weak validation of redirect_uri (allowing any path on the domain) lets attackers intercept authorization codes 

even on trusted domains.

## User Experience vs. Security:

Relies on a third party identity providers makes signing up and logging in faster and easier. User don't need to create a new paswsword or remember another set of credentials. It can increase adoption and improve 

user experience.While thinking about the security they have to make proper check to handle the risk. Poor implementation (e.g., weak redirect URI validation, missing state parameters, or unsafe token storage) can 

expose users to attacks like CSRF, token theft, or account compromise.The development team gains user convenience but must invest effort into proper security measures to prevent OAuth-related attacks. Using OAuth 

(like “Login with Google”) improves user convenience but increases security responsibility, because the app must carefully handle tokens and authorization flows to prevent attacks.





